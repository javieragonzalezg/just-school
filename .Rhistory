title = "Mujer"
)
mujer_caso2
mujer_caso1 <- datos_exp %>% dplyr::filter(genero=="Mujer") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Mujer"
)
mujer_caso1
hombre_caso1 <- datos_exp %>% dplyr::filter(genero=="Hombre") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Hombre"
)
hombre_caso1
plot_caso1 <- datos_exp %>% select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Caso 1 (sin características)"
) # tienden a darle (en la misma medida) mas a uno
plot_caso1
mujer_caso1 <- datos_exp %>% dplyr::filter(genero=="Mujer") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Mujer"
)
mujer_caso1
hombre_caso1 <- datos_exp %>% dplyr::filter(genero=="Hombre") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Hombre"
)
hombre_caso1
curso_caso1 <- datos_exp %>% dplyr::filter(curso) %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1 <- datos_exp %>% dplyr::filter(curso=="Básica", "Media") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
library(dplyr)
library(sjmisc)
curso_caso1 <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() +  # Crear el gráfico de frecuencia apilado
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Distribución de Décimas"
)
curso_caso1
curso_caso1 <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() +  # Crear el gráfico de frecuencia apilado
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
libros_hogar_caso1 <- datos_exp %>%
filter(curso %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Libros en el hogar"
)
libros_hogar_caso1 <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Libros en el hogar"
)
libros_hogar_caso1
educ_max_caso1 <- datos_exp %>%
filter(educ_max %in% c("Enseñanza media o menos", "Estudios superiores")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Nivel educacional de los padres"
)
educ_max_caso1
educ_max_caso1 <- datos_exp %>%
filter(educ_max %in% c("Enseñanza media o menos", "Estudios superiores")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Nivel educacional de los padres"
)
educ_max_caso1
# Calcular las frecuencias originales
frecuencias_originales <- datos %>%
pivot_longer(cols = c(genero_ES, curso_estudiante, educ_max, libros_hogar),
names_to = "variable",
values_to = "categoria") %>%
group_by(variable, categoria) %>%
summarise(Freq_Original = n(), .groups = 'drop')
pacman::p_load(dplyr, sjmisc, car, sjlabelled, stargazer, haven, sjPlot, ggplot2, tidyr, stringr, corrplot)
load("../input/data/proc/ola1.RData")
datos <- proc_datos %>% select(notas_esfuerzo, notas_merit,
justicia_nota, justicia_nota_ch,
justicia_nota_tiempo_ch,
genero_ES,
libros_hogar, curso_estudiante,
educ_max, school_esfuerzo_ES,
school_talento_ES,
school_merito_ES,
merit_esfuerzo_percep_ES,
merit_talento_percep_ES,
social_merito_percep_ES,
rendimiento
)
print(summarytools::dfSummary(datos), method="render")
# Calcular las frecuencias originales
frecuencias_originales <- datos %>%
pivot_longer(cols = c(genero_ES, curso_estudiante, educ_max, libros_hogar),
names_to = "variable",
values_to = "categoria") %>%
group_by(variable, categoria) %>%
summarise(Freq_Original = n(), .groups = 'drop')
# Combinar las frecuencias originales con la base transformada
proc_datos_largo <- proc_datos %>%
pivot_longer(cols = c(genero_ES, curso_estudiante, educ_max, libros_hogar),
names_to = "variable",
values_to = "categoria")
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, justicia_nota_ch) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# nombre facet_wrap
variable_names <- list("curso_estudiante" = "Curso",
"educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Crear la gráfica
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(justicia_nota_ch))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_text(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5), color = "black", size = 4.5) +
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
# fill = "Grado de acuerdo",
title = "Sensación de (in)justicia según características sociodemográficas "
) +
theme_blank() +
theme(
axis.text.y = element_blank(),  # Ocultar etiquetas del eje y
axis.ticks.y = element_blank(), # Ocultar marcas del eje y
axis.title.x = element_blank(), # Ocultar título del eje x
axis.title.y = element_blank(), # Ocultar título del eje y
strip.text = element_text(size = 9, face = "bold"), # Ajustar tamaño y estilo del título de las facetas
axis.text.x = element_text(size = 9), # Ajustar el tamaño de las etiquetas del eje x
legend.position = "bottom",# Colocar la leyenda en la parte inferior
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "injusticia sub-recompensa",
"2" = "justicia perfecta",
"3" = "injusticia sobre-recompensa"),
name = NULL)
tabla_cruzada_g <- sjt.xtab(datos$justicia_nota_ch,
datos$genero_ES,
show.summary = F,
emph.total = T,
show.col.prc = T, # porcentaje columna
encoding= "UTF-8")
tabla_cruzada_g
plot_caso4 <- datos_exp %>% select(c4_A:c4_D) %>%
plot_stackfrq(wrap.labels = 15) + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Caso 4 (esfuerzo y condiciones hogar)"
)
plot_caso4
mujer_caso4 <- datos_exp %>% dplyr::filter(genero=="Mujer") %>%
dplyr::select(c4_A, c4_B, c4_C, c4_D) %>%
plot_stackfrq() + theme(legend.position="right") +
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Distribución de Décimas en Mujeres"
)
mujer_caso4
hombre_caso4 <- datos_exp %>% dplyr::filter(genero=="Hombre") %>%
dplyr::select(c4_A, c4_B, c4_C, c4_D) %>%
plot_stackfrq() + theme(legend.position="right") +
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Distribución de Décimas en Hombres"
)
hombre_caso4
hombre_caso4 <- datos_exp %>% dplyr::filter(genero=="Hombre") %>%
dplyr::select(c4_A, c4_B, c4_C, c4_D) %>%
plot_stackfrq() + theme(legend.position="right") +
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Distribución de Décimas en Hombres"
)
hombre_caso4
library(dplyr)
library(tidyr)
library(ggplot2)
datos_long <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
pivot_longer(cols = c(c4_A, c4_B, c4_C, c4_D), names_to = "variable", values_to = "value")
curso_caso4 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ curso) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Distribución de Décimas por Curso"
)
curso_caso4
datos_long <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
pivot_longer(cols = c(c4_A, c4_B, c4_C, c4_D), names_to = "variable", values_to = "value")
libros_hogar_caso4 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ libros_hogar) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Distribución de Décimas según Libros en el Hogar"
)
libros_hogar_caso4
datos_long <- datos_exp %>%
filter(educ_max %in% c("Enseñanza media o menos", "Estudios superiores")) %>%
pivot_longer(cols = c(c4_A, c4_B, c4_C, c4_D), names_to = "variable", values_to = "value")
educ_max_caso4 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ educ_max) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Distribución de Décimas según Nivel Educacional de los Padres"
)
educ_max_caso4
mujer_caso1 <- datos_exp %>% dplyr::filter(genero=="Mujer") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Mujer"
)
mujer_caso1
hombre_caso1 <- datos_exp %>% dplyr::filter(genero=="Hombre") %>%
dplyr::select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position="right")+
labs(
x = NULL, # Elimina el título del eje x
y = NULL, # Elimina el título del eje y
fill = "Décimas",
title = "Hombre"
)
hombre_caso1
library(dplyr)
library(sjmisc)
curso_caso1 <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
library(dplyr)
library(sjmisc)
curso_caso1 <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
libros_hogar_caso1 <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Libros en el hogar"
)
libros_hogar_caso1
libros_hogar_caso1 <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Libros en el hogar"
)
libros_hogar_caso1
library(dplyr)
library(tidyr)
library(ggplot2)
datos_long <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
curso_caso4 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ curso) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
curso_caso1 <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
datos_long <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
curso_caso4 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ curso) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
library(dplyr)
library(tidyr)
library(ggplot2)
datos_long <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
libros_hogar_caso1 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ libros_hogar) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Libros en el Hogar"
)
libros_hogar_caso1
libros_hogar_caso1 <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
select(c1_A, c1_B) %>%
plot_stackfrq() + theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = NULL,  # Elimina el título del eje y
fill = "Décimas",
title = "Libros en el hogar"
)
libros_hogar_caso1
library(dplyr)
library(tidyr)
library(ggplot2)
datos_long <- datos_exp %>%
filter(libros_hogar %in% c("Más de 25 libros", "Menos de 25 libros")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
libros_hogar_caso1 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ libros_hogar) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Libros en el Hogar"
)
libros_hogar_caso1
library(dplyr)
library(tidyr)
library(ggplot2)
datos_long <- datos_exp %>%
filter(curso %in% c("Básica", "Media")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
curso_caso1 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ curso) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Curso"
)
curso_caso1
datos_long <- datos_exp %>%
filter(educ_max %in% c("Enseñanza media o menos", "Estudios superiores")) %>%
pivot_longer(cols = c(c1_A, c1_B), names_to = "variable", values_to = "value")
educ_max_caso1 <- ggplot(datos_long, aes(x = variable, y = value, fill = as.factor(value))) +
geom_bar(stat = "identity", position = "fill") +
facet_wrap(~ educ_max) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "right") +
labs(
x = NULL,  # Elimina el título del eje x
y = "Porcentaje",  # Cambia el título del eje y
fill = "Décimas",
title = "Nivel educacional de los padres"
)
educ_max_caso1
